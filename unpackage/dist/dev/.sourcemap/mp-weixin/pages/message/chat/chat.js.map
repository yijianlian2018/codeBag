{"version":3,"sources":["webpack:////Users/shiguangpeng/Documents/Work/yijianlian/main.js","webpack:////Users/shiguangpeng/Documents/Work/yijianlian/pages/message/chat/chat.vue?ce4b","webpack:////Users/shiguangpeng/Documents/Work/yijianlian/pages/message/chat/chat.vue?f5e3","webpack:////Users/shiguangpeng/Documents/Work/yijianlian/pages/message/chat/chat.vue?d472","webpack:////Users/shiguangpeng/Documents/Work/yijianlian/pages/message/chat/chat.vue?53a6","webpack:////Users/shiguangpeng/Documents/Work/yijianlian/pages/message/chat/chat.vue","webpack:////Users/shiguangpeng/Documents/Work/yijianlian/pages/message/chat/chat.vue?030f","webpack:////Users/shiguangpeng/Documents/Work/yijianlian/pages/message/chat/chat.vue?a8b3","webpack:////Users/shiguangpeng/Documents/Work/yijianlian/pages/message/chat/chat.vue?ae0c","webpack:////Users/shiguangpeng/Documents/Work/yijianlian/pages/message/chat/chat.vue?7588"],"names":["createPage","Page","data","user","textMsg","isHistoryLoading","scrollAnimation","scrollTop","scrollToView","pageNum","pageSize","more","msgList","myuid","msg","onShareAppMessage","token","uni","getStorageSync","title","path","server_people_id","computed","onLoad","opt","JSON","parse","uList","user_id","id","console","log","count","setMsgNum","msgNum","item","updateUlist","setNavigationBarTitle","user_name","getMsgList","$Fetch","url","success","res","$on","type","push","length","$nextTick","showModal","content","showCancel","screenMsg","onUnload","$off","methods","hideKeyboard","hideDrawer","loadHistory","to_user_id","setTimeout","reverse","concat","sendText","userInfo","nowDate","Date","that","trim","sendSocketMessage","stringify","discard"],"mappings":";;;;;;;;;;kDAAA,wCAAmB;;AAEnB;AACA,kG;AACAA,UAAU,CAACC,aAAD,CAAV,C;;;;;;;;;;;;;ACJA;AAAA;AAAA;AAAA;AAAA;AAAA;AAAA;AAA+F;AACvC;AACL;AACa;AACyB;;;AAGzF;AAC6K;AAC7K,gBAAgB,4KAAU;AAC1B,EAAE,0EAAM;AACR,EAAE,2FAAM;AACR,EAAE,oGAAe;AACjB;AACA;AACA;AACA;;AAEA;;AAEA;AACA,IAAI,KAAU,EAAE,YAiBf;AACD;AACe,gF;;;;;;;;;;;;ACxCf;AAAA;AAAA;AAAA;AAAA;AAAA;;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AACA;AACA;AACA;AACA;AACA;AACA;;;;;;;;;;;;;;ACNA;AAAA;AAAA;AAAA;AAAs+B,CAAgB,65BAAG,EAAC,C;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;;AC8D1/B,gD;AACe;AACdC,MADc,kBACP;AACN,WAAO;AACNC,UAAI,EAAE,IADA;AAEN;AACAC,aAAO,EAAE,EAHH;AAIN;AACAC,sBAAgB,EAAE,KALZ;AAMNC,qBAAe,EAAE,KANX;AAONC,eAAS,EAAE,CAPL;AAQNC,kBAAY,EAAE,EARR;AASNC,aAAO,EAAE,CATH;AAUNC,cAAQ,EAAE,EAVJ;AAWNC,UAAI,EAAE,IAXA;AAYNC,aAAO,EAAE,EAZH;AAaNC,WAAK,EAAE,CAbD;AAcNC,SAAG,EAAE,IAdC,EAAP;;AAgBA,GAlBa;AAmBdC,mBAnBc,+BAmBM;AACnB,QAAIC,KAAK,GAAGC,GAAG,CAACC,cAAJ,CAAmB,OAAnB,CAAZ;AACA,QAAIf,IAAI,GAAGc,GAAG,CAACC,cAAJ,CAAmB,UAAnB,CAAX;AACA,QAAIF,KAAJ,EAAW;AACV,aAAO;AACNG,aAAK,EAAE,WADD;AAENC,YAAI,EAAE,+BAA+BjB,IAAI,CAACkB,gBAFpC,EAAP;;AAIA;AACD,GA5Ba;AA6BdC,UAAQ;AACJ,sBAAS,CAAC,UAAD,EAAa,OAAb,EAAsB,QAAtB,CAAT,CADI,CA7BM;;AAgCdC,QAhCc,kBAgCPC,GAhCO,EAgCF;AACX,QAAIA,GAAG,CAACrB,IAAR,EAAc;AACb,UAAIA,IAAI,GAAGsB,IAAI,CAACC,KAAL,CAAWF,GAAG,CAACrB,IAAf,CAAX;AACA,UAAIwB,KAAK,GAAG,KAAKA,KAAjB;AACA,UAAIxB,IAAI,CAACyB,OAAT,EAAkB;AACjBzB,YAAI,CAAC0B,EAAL,GAAU1B,IAAI,CAACyB,OAAf;AACA;;AAEDE,aAAO,CAACC,GAAR,CAAY5B,IAAI,CAAC6B,KAAjB;AACA,UAAI7B,IAAI,CAAC6B,KAAT,EAAgB;AACf,aAAKC,SAAL,CAAe,KAAKC,MAAL,GAAc/B,IAAI,CAAC6B,KAAlC;AACA,OAVY;AAWb,6BAAiBL,KAAjB,8HAAwB,KAAfQ,IAAe;AACvB,cAAIA,IAAI,CAACN,EAAL,KAAY1B,IAAI,CAAC0B,EAArB,EAAyB;AACxBM,gBAAI,CAACH,KAAL,GAAa,CAAb;AACA;AACD,SAfY;AAgBb,WAAKI,WAAL,CAAiBT,KAAjB;AACA,WAAKxB,IAAL,GAAYA,IAAZ;AACAc,SAAG,CAACoB,qBAAJ,CAA0B;AACzBlB,aAAK,EAAEhB,IAAI,CAACmC,SADa,EAA1B;;AAGA,WAAKC,UAAL;AACA,WAAKC,MAAL,CAAY;AACXC,WAAG,EAAE,qBADM;AAEXC,eAAO,EAAE,iBAAAC,GAAG,EAAI;AACfb,iBAAO,CAACC,GAAR,CAAY,MAAZ,EAAoBY,GAApB;AACA,eAAI,CAACV,SAAL,CAAeU,GAAf;AACA,SALU,EAAZ;;AAOA;AACD;AACA1B,OAAG,CAAC2B,GAAJ,CAAQ,WAAR,EAAqB,UAAA9B,GAAG,EAAI;AAC3B,UAAIA,GAAG,CAAC+B,IAAJ,KAAa,MAAjB,EAAyB;AACxB,aAAI,CAACjC,OAAL,CAAakC,IAAb,CAAkBhC,GAAlB;AACAgB,eAAO,CAACC,GAAR,CAAY,KAAI,CAACnB,OAAL,CAAamC,MAAb,GAAsB,CAAlC;AACA,aAAI,CAACC,SAAL,CAAe,YAAW;AACzB;AACA,eAAKxC,YAAL,GAAoB,SAAS,KAAKI,OAAL,CAAamC,MAAb,GAAsB,CAA/B,CAApB;AACA,SAHD;AAIA,OAPD,MAOO,IAAIjC,GAAG,CAAC+B,IAAJ,KAAa,SAAjB,EAA4B;AAClC5B,WAAG,CAACgC,SAAJ,CAAc;AACbC,iBAAO,EAAE,iBADI;AAEbC,oBAAU,EAAE,KAFC,EAAd;;AAIA,aAAI,CAACC,SAAL,CAAe,KAAI,CAACtC,GAApB;AACA,aAAI,CAACV,OAAL,GAAe,EAAf;AACA,aAAI,CAACU,GAAL,GAAW,IAAX;AACA,OARM,MAQA,IAAIA,GAAG,CAAC+B,IAAJ,KAAa,SAAjB,EAA4B;AAClC,aAAI,CAACO,SAAL,CAAe,KAAI,CAACtC,GAApB;AACA,aAAI,CAACV,OAAL,GAAe,EAAf;AACA,aAAI,CAACU,GAAL,GAAW,IAAX;AACA;AACD,KArBD;AAsBA,GAtFa;AAuFduC,UAvFc,sBAuFH;AACVpC,OAAG,CAACqC,IAAJ,CAAS,WAAT;AACA,GAzFa;AA0FdC,SAAO;AACH,0BAAa,CAAC,UAAD,EAAa,WAAb,EAA0B,aAA1B,CAAb,CADG;AAEN;AACAH,aAHM,qBAGItC,GAHJ,EAGS;AACd;AACAG,SAAG,CAACuC,YAAJ;AACA,WAAK5C,OAAL,CAAakC,IAAb,CAAkBhC,GAAlB;AACA,WAAKkC,SAAL,CAAe,YAAW;AACzB;AACA,aAAKxC,YAAL,GAAoB,SAAS,KAAKI,OAAL,CAAamC,MAAb,GAAsB,CAA/B,CAApB;AACA,OAHD;AAIA,KAXK;AAYNU,cAZM,wBAYO;AACZ;AACA,KAdK;AAeN;AACAC,eAhBM,yBAgBQ;AACb,UAAI,CAAC,KAAK/C,IAAV,EAAgB;AACf;AACA;AACD,WAAKA,IAAL,GAAY,KAAZ;AACA,WAAKN,gBAAL,GAAwB,IAAxB,CALa,CAKiB;AAC9B,WAAKC,eAAL,GAAuB,KAAvB,CANa,CAMiB;AAC9B,WAAKkC,MAAL,CAAY;AACXC,WAAG,EAAE,mBADM;AAEXvC,YAAI,EAAE;AACLyD,oBAAU,EAAE,KAAKxD,IAAL,CAAU0B,EADjB;AAELpB,iBAAO,EAAE,KAAKA,OAFT;AAGLC,kBAAQ,EAAE,KAAKA,QAHV,EAFK;;AAOXgC,eAAO,EAAE,iBAAAC,GAAG,EAAI;AACfiB,oBAAU,CAAC,YAAM;AAChB,gBAAIjB,GAAG,CAACI,MAAJ,GAAa,CAAjB,EAAoB;AACnB,oBAAI,CAACnC,OAAL,GAAe+B,GAAG,CAACkB,OAAJ,GAAcC,MAAd,CAAqB,MAAI,CAAClD,OAA1B,CAAf;AACA,kBAAI+B,GAAG,CAACI,MAAJ,KAAe,MAAI,CAACrC,QAAxB,EAAkC;AACjC,sBAAI,CAACC,IAAL,GAAY,IAAZ;AACA;AACA,sBAAI,CAACqC,SAAL,CAAe,YAAW;AACzBlB,yBAAO,CAACC,GAAR,CAAY,KAAKnB,OAAL,CAAamC,MAAb,GAAsB,CAAlC;AACA,uBAAKvC,YAAL,GAAoB,QAAQmC,GAAG,CAACI,MAAhC,CAFyB,CAEe;AACxC,uBAAKC,SAAL,CAAe,YAAW;AACzB,yBAAK1C,eAAL,GAAuB,IAAvB,CADyB,CACI;AAC7B,mBAFD;AAGA,iBAND;AAOA,sBAAI,CAACD,gBAAL,GAAwB,KAAxB;AACA,sBAAI,CAACI,OAAL;AACA,eAZD,MAYO;AACN,sBAAI,CAACJ,gBAAL,GAAwB,KAAxB;AACA;AACD;AACD,WAnBS,EAmBP,IAnBO,CAAV;AAoBA,SA5BU,EAAZ;;AA8BA,KArDK;AAsDN;AACAkC,cAvDM,wBAuDO;AACZ,WAAK5B,IAAL,GAAY,KAAZ;AACA,WAAKL,eAAL,GAAuB,KAAvB,CAFY,CAEkB;AAC9B,WAAKkC,MAAL,CAAY;AACXC,WAAG,EAAE,mBADM;AAEXvC,YAAI,EAAE;AACLyD,oBAAU,EAAE,KAAKxD,IAAL,CAAU0B,EADjB;AAELpB,iBAAO,EAAE,KAAKA,OAFT;AAGLC,kBAAQ,EAAE,KAAKA,QAHV,EAFK;;AAOXgC,eAAO,EAAE,iBAAAC,GAAG,EAAI;AACf,cAAIA,GAAG,CAACI,MAAJ,GAAa,CAAjB,EAAoB;AACnB,kBAAI,CAACnC,OAAL,GAAe+B,GAAG,CAACkB,OAAJ,GAAcC,MAAd,CAAqB,MAAI,CAAClD,OAA1B,CAAf;AACA,gBAAI+B,GAAG,CAACI,MAAJ,KAAe,MAAI,CAACrC,QAAxB,EAAkC;AACjC,oBAAI,CAACC,IAAL,GAAY,IAAZ;AACA,oBAAI,CAACF,OAAL;AACA;AACD;AACA,kBAAI,CAACuC,SAAL,CAAe,YAAW;AACzB,mBAAKxC,YAAL,GAAoB,SAAS,KAAKI,OAAL,CAAamC,MAAb,GAAsB,CAA/B,CAApB,CADyB,CAC8B;AACvD,mBAAKC,SAAL,CAAe,YAAW;AACzB,qBAAK1C,eAAL,GAAuB,IAAvB,CADyB,CACI;AAC7B,eAFD;AAGA,aALD;AAMA;AACD,SAtBU,EAAZ;;AAwBA,KAlFK;;AAoFN;AACAyD,YArFM,sBAqFK;AACVjC,aAAO,CAACC,GAAR,CAAY,KAAKiC,QAAjB;AACA;AACA,UAAIC,OAAO,GAAG,IAAIC,IAAJ,EAAd;AACA,UAAIC,IAAI,GAAG,IAAX;AACA,UAAIrD,GAAG,GAAG;AACToC,eAAO,EAAE,KAAK9C,OADL;AAETuD,kBAAU,EAAE,KAAKxD,IAAL,CAAU0B,EAFb;AAGTD,eAAO,EAAE,KAAKoC,QAAL,CAAcnC,EAHd;AAITgB,YAAI,EAAE,KAJG,EAAV;;AAMA,UAAI,CAAC,KAAKzC,OAAL,CAAagE,IAAb,EAAL,EAA0B;AACzB;AACAnD,WAAG,CAACgC,SAAJ,CAAc;AACbC,iBAAO,EAAE,UADI;AAEbC,oBAAU,EAAE,KAFC,EAAd;;AAIA,OAND,MAMO;AACN,YAAIgB,KAAI,GAAG,IAAX;AACA,aAAKrD,GAAL,GAAWA,GAAX;AACAG,WAAG,CAACoD,iBAAJ,CAAsB;AACrBnE,cAAI,EAAEuB,IAAI,CAAC6C,SAAL,CAAexD,GAAf,CADe;AAErB4B,iBAAO,EAAE,mBAAW;AACnByB,iBAAI,CAAC3B,MAAL,CAAY;AACXC,iBAAG,EAAE,uBADM;AAEXC,qBAAO,EAAE,iBAAAC,GAAG,EAAI;AACfwB,qBAAI,CAAC/B,WAAL,CAAiBO,GAAjB;AACA,eAJU,EAAZ;;AAMA,WAToB,EAAtB;;AAWA;AACD,KArHK;;AAuHN4B,WAvHM,qBAuHI;AACT;AACA,KAzHK,GA1FO,E;;;;;;;;;;;;;AC/Df;AAAA;AAAA;AAAA;AAAgzC,CAAgB,krCAAG,EAAC,C;;;;;;;;;;;ACAp0C,uC;;;;;;;;;;;;ACAA;AAAA;AAAA;AAAA;AAA4pD,CAAgB,y+CAAG,EAAC,C;;;;;;;;;;;ACAhrD,uC","file":"pages/message/chat/chat.js","sourcesContent":["import 'uni-pages';import '@dcloudio/uni-stat';\n\nimport Vue from 'vue'            \nimport Page from './pages/message/chat/chat.vue'\ncreatePage(Page)","import { render, staticRenderFns } from \"./chat.vue?vue&type=template&id=9799b8f4&scoped=true&\"\nimport script from \"./chat.vue?vue&type=script&lang=js&\"\nexport * from \"./chat.vue?vue&type=script&lang=js&\"\nimport style0 from \"./chat.vue?vue&type=style&index=0&lang=css&\"\nimport style1 from \"./chat.vue?vue&type=style&index=1&id=9799b8f4&lang=scss&scoped=true&\"\n\n\n/* normalize component */\nimport normalizer from \"!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/runtime/componentNormalizer.js\"\nvar component = normalizer(\n  script,\n  render,\n  staticRenderFns,\n  false,\n  null,\n  \"9799b8f4\",\n  null\n  \n)\n\n/* hot reload */\nif (module.hot) {\n  var api = require(\"/Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-hot-reload-api/dist/index.js\")\n  api.install(require('vue'))\n  if (api.compatible) {\n    module.hot.accept()\n    if (!module.hot.data) {\n      api.createRecord('9799b8f4', component.options)\n    } else {\n      api.reload('9799b8f4', component.options)\n    }\n    module.hot.accept(\"./chat.vue?vue&type=template&id=9799b8f4&scoped=true&\", function () {\n      api.rerender('9799b8f4', {\n        render: render,\n        staticRenderFns: staticRenderFns\n      })\n    })\n  }\n}\ncomponent.options.__file = \"Users/shiguangpeng/Documents/Work/yijianlian/pages/message/chat/chat.vue\"\nexport default component.exports","export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-hbuilderx/packages/webpack-uni-nvue-loader/lib/templateLoader.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--17-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/template.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=template&id=9799b8f4&scoped=true&\"","var render = function() {\n  var _vm = this\n  var _h = _vm.$createElement\n  var _c = _vm._self._c || _h\n}\nvar staticRenderFns = []\nrender._withStripped = true\n\nexport { render, staticRenderFns }","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=script&lang=js&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/babel-loader/lib/index.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--12-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/script.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=script&lang=js&\"","//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n//\n\nimport { mapState, mapMutations } from 'vuex';\nexport default {\n\tdata() {\n\t\treturn {\n\t\t\tuser: null,\n\t\t\t//文字消息\n\t\t\ttextMsg: '',\n\t\t\t//消息列表\n\t\t\tisHistoryLoading: false,\n\t\t\tscrollAnimation: false,\n\t\t\tscrollTop: 0,\n\t\t\tscrollToView: '',\n\t\t\tpageNum: 1,\n\t\t\tpageSize: 20,\n\t\t\tmore: true,\n\t\t\tmsgList: [],\n\t\t\tmyuid: 0,\n\t\t\tmsg: null\n\t\t};\n\t},\n\tonShareAppMessage() {\n\t\tlet token = uni.getStorageSync('TOKEN');\n\t\tlet user = uni.getStorageSync('userInfo');\n\t\tif (token) {\n\t\t\treturn {\n\t\t\t\ttitle: '易建联共享服务平台',\n\t\t\t\tpath: '/pages/index/index?server=' + user.server_people_id\n\t\t\t};\n\t\t}\n\t},\n\tcomputed: {\n\t\t...mapState(['userInfo', 'uList', 'msgNum'])\n\t},\n\tonLoad(opt) {\n\t\tif (opt.user) {\n\t\t\tlet user = JSON.parse(opt.user);\n\t\t\tlet uList = this.uList;\n\t\t\tif (user.user_id) {\n\t\t\t\tuser.id = user.user_id;\n\t\t\t}\n\n\t\t\tconsole.log(user.count);\n\t\t\tif (user.count) {\n\t\t\t\tthis.setMsgNum(this.msgNum - user.count);\n\t\t\t}\n\t\t\tfor (let item of uList) {\n\t\t\t\tif (item.id === user.id) {\n\t\t\t\t\titem.count = 0;\n\t\t\t\t}\n\t\t\t}\n\t\t\tthis.updateUlist(uList);\n\t\t\tthis.user = user;\n\t\t\tuni.setNavigationBarTitle({\n\t\t\t\ttitle: user.user_name\n\t\t\t});\n\t\t\tthis.getMsgList();\n\t\t\tthis.$Fetch({\n\t\t\t\turl: 'user_chat/NoReadNum',\n\t\t\t\tsuccess: res => {\n\t\t\t\t\tconsole.log('未读消息', res);\n\t\t\t\t\tthis.setMsgNum(res);\n\t\t\t\t}\n\t\t\t});\n\t\t}\n\t\t//接受消息\n\t\tuni.$on('onMessage', msg => {\n\t\t\tif (msg.type === 'text') {\n\t\t\t\tthis.msgList.push(msg);\n\t\t\t\tconsole.log(this.msgList.length - 1);\n\t\t\t\tthis.$nextTick(function() {\n\t\t\t\t\t// 滚动到底\n\t\t\t\t\tthis.scrollToView = 'msg' + (this.msgList.length - 1);\n\t\t\t\t});\n\t\t\t} else if (msg.type === 'outline') {\n\t\t\t\tuni.showModal({\n\t\t\t\t\tcontent: '对方离线，只能发送一条离线消息',\n\t\t\t\t\tshowCancel: false\n\t\t\t\t});\n\t\t\t\tthis.screenMsg(this.msg);\n\t\t\t\tthis.textMsg = '';\n\t\t\t\tthis.msg = null;\n\t\t\t} else if (msg.type === 'success') {\n\t\t\t\tthis.screenMsg(this.msg);\n\t\t\t\tthis.textMsg = '';\n\t\t\t\tthis.msg = null;\n\t\t\t}\n\t\t});\n\t},\n\tonUnload() {\n\t\tuni.$off('onMessage');\n\t},\n\tmethods: {\n\t\t...mapMutations(['addUlist', 'setMsgNum', 'updateUlist']),\n\t\t// 接受消息(筛选处理)\n\t\tscreenMsg(msg) {\n\t\t\t//从长连接处转发给这个方法，进行筛选处理\n\t\t\tuni.hideKeyboard();\n\t\t\tthis.msgList.push(msg);\n\t\t\tthis.$nextTick(function() {\n\t\t\t\t// 滚动到底\n\t\t\t\tthis.scrollToView = 'msg' + (this.msgList.length - 1);\n\t\t\t});\n\t\t},\n\t\thideDrawer() {\n\t\t\t// uni.hideKeyboard();\n\t\t},\n\t\t//触发滑动到顶部(加载历史信息记录)\n\t\tloadHistory() {\n\t\t\tif (!this.more) {\n\t\t\t\treturn;\n\t\t\t}\n\t\t\tthis.more = false;\n\t\t\tthis.isHistoryLoading = true; //参数作为进入请求标识，防止重复请求\n\t\t\tthis.scrollAnimation = false; //关闭滑动动画\n\t\t\tthis.$Fetch({\n\t\t\t\turl: 'user_chat/getData',\n\t\t\t\tdata: {\n\t\t\t\t\tto_user_id: this.user.id,\n\t\t\t\t\tpageNum: this.pageNum,\n\t\t\t\t\tpageSize: this.pageSize\n\t\t\t\t},\n\t\t\t\tsuccess: res => {\n\t\t\t\t\tsetTimeout(() => {\n\t\t\t\t\t\tif (res.length > 0) {\n\t\t\t\t\t\t\tthis.msgList = res.reverse().concat(this.msgList);\n\t\t\t\t\t\t\tif (res.length === this.pageSize) {\n\t\t\t\t\t\t\t\tthis.more = true;\n\t\t\t\t\t\t\t\t//这段代码很重要，不然每次加载历史数据都会跳到顶部\n\t\t\t\t\t\t\t\tthis.$nextTick(function() {\n\t\t\t\t\t\t\t\t\tconsole.log(this.msgList.length - 1);\n\t\t\t\t\t\t\t\t\tthis.scrollToView = 'msg' + res.length; //跳转上次的第一行信息位置\n\t\t\t\t\t\t\t\t\tthis.$nextTick(function() {\n\t\t\t\t\t\t\t\t\t\tthis.scrollAnimation = true; //恢复滚动动画\n\t\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\t});\n\t\t\t\t\t\t\t\tthis.isHistoryLoading = false;\n\t\t\t\t\t\t\t\tthis.pageNum++;\n\t\t\t\t\t\t\t} else {\n\t\t\t\t\t\t\t\tthis.isHistoryLoading = false;\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t}\n\t\t\t\t\t}, 1500);\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\t\t// 加载初始页面消息\n\t\tgetMsgList() {\n\t\t\tthis.more = false;\n\t\t\tthis.scrollAnimation = false; //关闭滑动动画\n\t\t\tthis.$Fetch({\n\t\t\t\turl: 'user_chat/getData',\n\t\t\t\tdata: {\n\t\t\t\t\tto_user_id: this.user.id,\n\t\t\t\t\tpageNum: this.pageNum,\n\t\t\t\t\tpageSize: this.pageSize\n\t\t\t\t},\n\t\t\t\tsuccess: res => {\n\t\t\t\t\tif (res.length > 0) {\n\t\t\t\t\t\tthis.msgList = res.reverse().concat(this.msgList);\n\t\t\t\t\t\tif (res.length === this.pageSize) {\n\t\t\t\t\t\t\tthis.more = true;\n\t\t\t\t\t\t\tthis.pageNum++;\n\t\t\t\t\t\t}\n\t\t\t\t\t\t//这段代码很重要，不然每次加载历史数据都会跳到顶部\n\t\t\t\t\t\tthis.$nextTick(function() {\n\t\t\t\t\t\t\tthis.scrollToView = 'msg' + (this.msgList.length - 1); //跳转上次的第一行信息位置\n\t\t\t\t\t\t\tthis.$nextTick(function() {\n\t\t\t\t\t\t\t\tthis.scrollAnimation = true; //恢复滚动动画\n\t\t\t\t\t\t\t});\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t}\n\t\t\t});\n\t\t},\n\n\t\t// 发送消息\n\t\tsendText() {\n\t\t\tconsole.log(this.userInfo);\n\t\t\t//实际应用中，此处应该提交长连接，模板仅做本地处理。\n\t\t\tvar nowDate = new Date();\n\t\t\tlet that = this;\n\t\t\tlet msg = {\n\t\t\t\tcontent: this.textMsg,\n\t\t\t\tto_user_id: this.user.id,\n\t\t\t\tuser_id: this.userInfo.id,\n\t\t\t\ttype: 'say'\n\t\t\t};\n\t\t\tif (!this.textMsg.trim()) {\n\t\t\t\t// uni.hideKeyboard();\n\t\t\t\tuni.showModal({\n\t\t\t\t\tcontent: '不能发送空白消息',\n\t\t\t\t\tshowCancel: false\n\t\t\t\t});\n\t\t\t} else {\n\t\t\t\tlet that = this;\n\t\t\t\tthis.msg = msg;\n\t\t\t\tuni.sendSocketMessage({\n\t\t\t\t\tdata: JSON.stringify(msg),\n\t\t\t\t\tsuccess: function() {\n\t\t\t\t\t\tthat.$Fetch({\n\t\t\t\t\t\t\turl: 'user_chat/getDataList',\n\t\t\t\t\t\t\tsuccess: res => {\n\t\t\t\t\t\t\t\tthat.updateUlist(res);\n\t\t\t\t\t\t\t}\n\t\t\t\t\t\t});\n\t\t\t\t\t}\n\t\t\t\t});\n\t\t\t}\n\t\t},\n\n\t\tdiscard() {\n\t\t\treturn;\n\t\t}\n\t}\n};\n","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=style&index=0&lang=css&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--6-oneOf-1-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--6-oneOf-1-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--6-oneOf-1-2!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--6-oneOf-1-3!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=style&index=0&lang=css&\"","// extracted by mini-css-extract-plugin","import mod from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-4!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=style&index=1&id=9799b8f4&lang=scss&scoped=true&\"; export default mod; export * from \"-!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/mini-css-extract-plugin/dist/loader.js??ref--8-oneOf-1-0!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/css-loader/index.js??ref--8-oneOf-1-2!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/loaders/stylePostLoader.js!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/postcss-loader/src/index.js??ref--8-oneOf-1-3!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/sass-loader/lib/loader.js??ref--8-oneOf-1-4!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-preprocess-loader/index.js??ref--8-oneOf-1-5!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/vue-loader/lib/index.js??vue-loader-options!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/vue-cli-plugin-uni/packages/webpack-custom-block-loader/index.js??ref--0-1!../../../../../../../../Applications/HBuilderX.app/Contents/HBuilderX/plugins/uniapp-cli/node_modules/@dcloudio/webpack-uni-mp-loader/lib/style.js!./chat.vue?vue&type=style&index=1&id=9799b8f4&lang=scss&scoped=true&\"","// extracted by mini-css-extract-plugin"],"sourceRoot":""}