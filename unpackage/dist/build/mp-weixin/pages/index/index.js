(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"2b5c":function(e,t,n){"use strict";(function(e){n("4ea4"),n("921b");o(n("66fd"));var t=o(n("c206"));function o(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},"2e2b":function(e,t,n){"use strict";n.r(t);var o=n("f429"),r=n.n(o);for(var i in o)"default"!==i&&function(e){n.d(t,e,function(){return o[e]})}(i);t["default"]=r.a},b4cb:function(e,t,n){},b623:function(e,t,n){"use strict";var o=n("b4cb"),r=n.n(o);r.a},bd5c:function(e,t,n){"use strict";var o=function(){var e=this,t=e.$createElement;e._self._c},r=[];n.d(t,"a",function(){return o}),n.d(t,"b",function(){return r})},c206:function(e,t,n){"use strict";n.r(t);var o=n("bd5c"),r=n("2e2b");for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);n("b623");var c=n("2877"),a=Object(c["a"])(r["default"],o["a"],o["b"],!1,null,"a1ab4eb8",null);t["default"]=a.exports},f429:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var o=n("2f62");function r(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},o=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(o=o.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),o.forEach(function(t){i(e,t,n[t])})}return e}function i(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=function(){return Promise.all([n.e("common/vendor"),n.e("components/articleList")]).then(n.bind(null,"29ef"))},a={data:function(){return{banner:[{img:n("ab3d")}],zizhi:[],type:1,more:!1,pageNum:1,pageSize:10,loading:!0,list:[],imgList:[]}},computed:r({},(0,o.mapState)(["isLogin","userInfo","city","uList","msgNum","count"])),components:{articleList:c},onShareAppMessage:function(){var t=e.getStorageSync("userInfo");if(e.getStorageSync("TOKEN"))return{title:"易建联共享服务平台",path:"/pages/index/index?server="+t.server_people_id}},onLoad:function(t){var n=this;this.$Fetch({url:"picture/getData",success:function(e){console.log(e),n.zizhi=e.picture;var t=!0,o=!1,r=void 0;try{for(var i,c=e.picture[Symbol.iterator]();!(t=(i=c.next()).done);t=!0){var a=i.value;n.imgList.push(a.img)}}catch(s){o=!0,r=s}finally{try{t||null==c.return||c.return()}finally{if(o)throw r}}e.banner.length>0&&(n.banner=e.banner)}}),this.getList(),t.server&&this.setShareMsg({server:t.server});var o=this;e.getStorageSync("TOKEN")&&(console.log(e.getStorageSync("TOKEN")),this.$Fetch({url:"user/getDataById",success:function(t){n.setInfo(t),e.setStorageSync("userInfo",t),e.connectSocket({url:"wss://yjl.tao.li4.cn:8282"}),e.onSocketOpen(function(n){console.log("WebSocket连接已打开！"),e.sendSocketMessage({data:JSON.stringify({type:"bind",user_id:t.id}),success:function(){console.log("发送成功")}}),e.onSocketMessage(function(t){o.$Fetch({url:"user_chat/getDataList",success:function(e){o.updateUlist(e)}});var n=JSON.parse(t.data);if(console.log(n),e.$emit("onMessage",n),"text"===n.type){o.setMsgNum(o.msgNum+1);var r=o.uList,i=!0,c=!1,a=void 0;try{for(var s,u=r[Symbol.iterator]();!(i=(s=u.next()).done);i=!0){var l=s.value;l.id===n.user_id&&(l.count?l.count++:l.count=1)}}catch(f){c=!0,a=f}finally{try{i||null==u.return||u.return()}finally{if(c)throw a}}o.updateUlist(r)}})}),e.onSocketClose(function(t){console.log("WebSocket 已关闭！"),e.getStorageSync("TOKEN")&&(console.log("服务器连接异常！重连中···"),e.connectSocket({url:"wss://yjl.tao.li4.cn:8282"}))}),e.onSocketError(function(t){console.log("服务器连接异常！重连中···"),e.getStorageSync("TOKEN")&&e.connectSocket({url:"wss://yjl.tao.li4.cn:8282"})}),n.$Fetch({url:"user_chat/NoReadNum",success:function(e){console.log("未读消息",e),n.setMsgNum(e)}}),n.$Fetch({url:"user_chat/getNoRead",success:function(e){var t=n.uList,o=!0,r=!1,i=void 0;try{for(var c,a=e[Symbol.iterator]();!(o=(c=a.next()).done);o=!0){var s=c.value;for(var u in t)if(s.user_id===t[u].id){var l=t[u];l.content=s.content,l.count=s.count,t[u]=l}}}catch(f){r=!0,i=f}finally{try{o||null==a.return||a.return()}finally{if(r)throw i}}n.updateUlist(t)}})}}))},onReachBottom:function(){this.getList()},methods:r({},(0,o.mapMutations)(["setInfo","updateUlist","setMsgNum","setCount","setShareMsg"]),(0,o.mapActions)(["navFilter"]),{previewImage:function(t){e.previewImage({current:t,urls:this.imgList})},getList:function(){var e=this;this.loading&&(this.loading=!1,this.$Fetch({url:"news/recommend",data:{pageNum:this.pageNum,pageSize:this.pageSize},success:function(t){var n=t.lists;n.length>0?(e.list=e.list.concat(n),n.length===e.pageSize?(e.pageNum++,e.loading=!0,e.more=!0):e.more=!1):e.more=!1}}))}})};t.default=a}).call(this,n("543d")["default"])}},[["2b5c","common/runtime","common/vendor"]]]);