(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/article/article"],{"0fab":function(e,t,n){"use strict";n.r(t);var i=n("ef7b"),o=n("5740");for(var s in o)"default"!==s&&function(e){n.d(t,e,function(){return o[e]})}(s);n("bf32");var a=n("2877"),c=Object(a["a"])(o["default"],i["a"],i["b"],!1,null,"168e817b",null);t["default"]=c.exports},1182:function(e,t,n){"use strict";(function(e){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var i=n("2f62");function o(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},i=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(i=i.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),i.forEach(function(t){s(e,t,n[t])})}return e}function s(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var a=function(){return n.e("components/uni-popup/uni-popup").then(n.bind(null,"4155"))},c=function(){return Promise.all([n.e("common/vendor"),n.e("components/articleList")]).then(n.bind(null,"29ef"))},r=function(){return Promise.all([n.e("common/vendor"),n.e("components/u-parse/u-parse")]).then(n.bind(null,"a5cc"))},u={data:function(){return{timer:null,videoContext:null,statusBarHeight:0,height:0,id:-1,show:!1,article:null,author:null,is_collect:0,is_like:0,attention:0,more:!1,type:0,list:[],comment:{pageNum:1,pageSize:10,list:[],loading:!0,more:!1},reply:{comment:{},pageNum:1,pageSize:10,list:[],loading:!0,more:!1},showInput:!1,showInput1:!1,content:"",content1:"",item:null,to_user_name:""}},computed:o({},(0,i.mapState)(["isLogin","userInfo"])),components:{articleList:c,uniPopup:a,uParse:r},onShareAppMessage:function(){var t=e.getStorageSync("TOKEN"),n=e.getStorageSync("userInfo");if(this.$Fetch({url:"news/share",data:{news_id:this.id},success:function(t){var n=t>0?"已分享,砖瓦+"+t:"已分享";e.showToast({title:n,icon:"none"})}}),t)return{title:"易建联共享服务平台",path:"/pages/index/article/article?id="+this.id+"&server="+n.server_people_id+"&path=/pages/index/article/article"}},onLoad:function(t){var n=this,i=e.getStorageSync("TOKEN"),o=this;if(!i)return this.setShareMsg({server:t.server,path:t.path+"?id="+t.id}),e.redirectTo({url:"/pages/login/login"}),!1;e.getSystemInfo({success:function(e){o.height=e.windowHeight/2+"px",o.statusBarHeight=e.statusBarHeight}}),e.hideKeyboard(),t.id&&(this.timer=setTimeout(function(){n.$Fetch({url:"news/read_news",data:{id:t.id},success:function(t){t>0&&e.showToast({title:"砖瓦数+"+t,icon:"success"})}})},5e3),this.id=t.id,this.$Fetch({url:"news/getDataById",data:{id:t.id},success:function(e){n.article=e,n.is_collect=e.is_collect,n.is_like=e.is_like,n.author=e.adminUser,n.attention=e.attention,n.type=e.type,n.getRecommend()}}),this.getCommentList())},onHide:function(){this.videoContext.pause(),console.log("页面隐藏了"),clearTimeout(this.timer),this.timer=null},onUnload:function(){console.log("页面销毁了"),this.videoContext.pause(),clearTimeout(this.timer),this.timer=null},onReady:function(){var t=this;this.videoContext=e.createVideoContext("myVideo"),setTimeout(function(){t.videoContext.play()},3e3)},methods:o({},(0,i.mapMutations)(["setShareMsg"]),{videoErrorCallback:function(){},back:function(){e.navigateBack({})},doShare:function(){var t=this;e.share({provider:"weixin",scene:"WXSceneSession",type:5,imageUrl:"../../static/poster.png",title:"欢迎使用易建联APP",miniProgram:{id:"gh_4bf03e4d36fb",path:"/pages/index/article/article?id="+this.id+"&server="+this.userInfo.server_people_id+"&path=/pages/index/article/article",webUrl:"https://uniapp.dcloud.io",type:2},success:function(n){console.log("success",n),e.showModal({content:"分享成功",showCancel:!1}),t.$Fetch({url:"news/share",data:{news_id:t.id},success:function(t){var n=t>0?"已分享,砖瓦+"+t:"已分享";e.showToast({title:n,icon:"none"})}})},fail:function(e){console.log("fail",e)},complete:function(){console.log("分享操作结束!")}})},send:function(){var t=this;if(!this.content.trim())return e.showModal({content:"请输入内容",showCancel:!1}),!1;this.$Fetch({url:"Comment/add",data:{comment_type:0,id_value:this.id,content:this.content},success:function(n){var i=new Date,o=i.getMonth()+1>9?i.getMonth()+1:"0"+(i.getMonth()+1),s=i.getDate()>9?i.getDate():"0"+i.getDate(),a=i.toTimeString().split(" ")[0];t.comment.list.unshift({user_id:t.userInfo.id,user_name:t.userInfo.user_name,content:t.content,create_time:i.getFullYear()+"-"+o+"-"+s+" "+a,like_num:0,head_img:t.userInfo.head_img,children:null,children_num:0,is_like:0}),t.content="",e.hideKeyboard(),t.showInput=!1}})},doReply:function(e,t){this.showInput1=!0,this.replyId=e,this.to_user_name=t},send1:function(){var t=this;if(!this.content1.trim())return e.showModal({content:"请输入内容",showCancel:!1}),!1;var n=this.reply.comment.id;console.log(n),this.$Fetch({url:"Comment/addComment",data:{parent_id:n,to_user_id:this.replyId,content:this.content1},success:function(n){var i=new Date,o=i.getMonth()+1>9?i.getMonth()+1:"0"+(i.getMonth()+1),s=i.getDate()>9?i.getDate():"0"+i.getDate(),a=i.toTimeString().split(" ")[0];t.replyId,t.reply.list.unshift({user_id:t.userInfo.id,user_name:t.userInfo.user_name,content:t.content1,create_time:i.getFullYear()+"-"+o+"-"+s+" "+a,like_num:0,head_img:t.userInfo.head_img,is_like:0,to_user_name:t.to_user_name}),t.content1="",e.hideKeyboard(),t.showInput1=!1}})},getRecommend:function(){var e=this;this.$Fetch({url:"news/get_recommend",data:{type:this.type},success:function(t){e.list=t}})},doAttention:function(t){var n=this;this.$Fetch({url:"Attention/add",data:{id:t},debug:!0,success:function(t){n.attention=t.success;var i=1===t.success?"已关注,砖瓦+"+t.point:"已取消关注";e.showToast({title:i,icon:"none"})}})},doCollect:function(t){var n=this;this.$Fetch({url:"Collect/add",data:{collect_type:t,id_value:this.id},success:function(t){n.is_collect=t.success;var i=1===t.success?"已收藏,砖瓦+"+t.point:"已取消收藏";e.showToast({title:i,icon:"none"})}})},doZan:function(t){var n=this;this.$Fetch({url:"user_like/add",data:{like_type:t,id_value:this.id},success:function(t){n.is_like=t.success;var i=1===t.success?"已点赞,砖瓦+"+t.point:"已取消点赞";e.showToast({title:i,icon:"none"})}})},getCommentList:function(){var e=this,t=this.comment;t.loading&&(t.loading=!1,this.comment=t,this.$Fetch({url:"Comment/getData",data:{comment_type:0,id_value:this.id,pageNum:t.pageNum,pageSize:t.pageSize},success:function(n){var i=n.lists;i.length>0?(t.list=t.list.concat(i),i.length===t.pageSize?(t.pageNum++,t.loading=!0,t.more=!0):t.more=!1):t.more=!1,e.comment=t}}))},addCommentLike:function(e,t){this.$Fetch({url:"Comment/addCommentLike",data:{id:e.id},success:function(t){e.is_like=t,1===t?e.like_num++:e.like_num--}})},closePopup:function(){this.show=!1,this.showInput1=!1,this.reply={comment:{},pageNum:1,pageSize:10,list:[],loading:!0,more:!1}},showPopup:function(e){this.item=e,this.getReply(e),this.show=!0},getReply:function(e){var t=this,n=this.reply;n.comment=e,this.reply=n,n.loading&&(n.loading=!1,this.reply=n,this.$Fetch({url:"Comment/getComment",data:{id:e.id,pageNum:n.pageNum,pageSize:n.pageSize},success:function(e){var i=e.length;i>0?(n.list=n.list.concat(e),i===n.pageSize?(n.pageNum++,n.loading=!0,n.more=!0):n.more=!1):n.more=!1,t.reply=n,t.show=!0}}))}})};t.default=u}).call(this,n("543d")["default"])},5740:function(e,t,n){"use strict";n.r(t);var i=n("1182"),o=n.n(i);for(var s in i)"default"!==s&&function(e){n.d(t,e,function(){return i[e]})}(s);t["default"]=o.a},"8afc":function(e,t,n){"use strict";(function(e){n("4ea4"),n("921b");i(n("66fd"));var t=i(n("0fab"));function i(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("543d")["createPage"])},bf32:function(e,t,n){"use strict";var i=n("fa40"),o=n.n(i);o.a},ef7b:function(e,t,n){"use strict";var i=function(){var e=this,t=e.$createElement;e._self._c;e._isMounted||(e.e0=function(t){e.showInput=!0})},o=[];n.d(t,"a",function(){return i}),n.d(t,"b",function(){return o})},fa40:function(e,t,n){}},[["8afc","common/runtime","common/vendor"]]]);