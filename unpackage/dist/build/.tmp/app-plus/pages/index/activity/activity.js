(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/activity/activity"],{"4d19":function(t,e,i){},"6b3d":function(t,e,i){"use strict";var n=i("4d19"),o=i.n(n);o.a},adbe:function(t,e,i){"use strict";var n=function(){var t=this,e=t.$createElement,i=(t._self._c,JSON.stringify(t.author));t._isMounted||(t.e0=function(e){t.show=!0},t.e1=function(e){t.showInput=!0},t.e2=function(e){t.show=!1}),t.$mp.data=Object.assign({},{$root:{g0:i}})},o=[];i.d(e,"a",function(){return n}),i.d(e,"b",function(){return o})},bcd5:function(t,e,i){"use strict";i.r(e);var n=i("de7d"),o=i.n(n);for(var a in n)"default"!==a&&function(t){i.d(e,t,function(){return n[t]})}(a);e["default"]=o.a},d313:function(t,e,i){"use strict";(function(t){i("4ea4"),i("921b");n(i("66fd"));var e=n(i("f054"));function n(t){return t&&t.__esModule?t:{default:t}}t(e.default)}).call(this,i("6e42")["createPage"])},de7d:function(t,e,i){"use strict";(function(t,n){Object.defineProperty(e,"__esModule",{value:!0}),e.default=void 0;var o=i("2f62");function a(t){for(var e=1;e<arguments.length;e++){var i=null!=arguments[e]?arguments[e]:{},n=Object.keys(i);"function"===typeof Object.getOwnPropertySymbols&&(n=n.concat(Object.getOwnPropertySymbols(i).filter(function(t){return Object.getOwnPropertyDescriptor(i,t).enumerable}))),n.forEach(function(e){s(t,e,i[e])})}return t}function s(t,e,i){return e in t?Object.defineProperty(t,e,{value:i,enumerable:!0,configurable:!0,writable:!0}):t[e]=i,t}var c=function(){return i.e("components/uni-popup/uni-popup").then(i.bind(null,"4155"))},u={data:function(){return{type:0,id:-1,activity:null,author:null,attention:0,is_collect:0,is_like:0,is_baoming:0,max:1,height:0,show:!1,pl:!1,comment:{pageNum:1,pageSize:10,list:[],loading:!0,more:!1},reply:{comment:{},pageNum:1,pageSize:10,list:[],loading:!0,more:!1},replyId:-1,to_user_name:"",showInput:!1,showInput1:!1,content:"",content1:""}},computed:a({},(0,o.mapState)(["isLogin","userInfo"])),components:{uniPopup:c},onShareAppMessage:function(){var e=t.getStorageSync("TOKEN"),i=t.getStorageSync("userInfo");if(this.$Fetch({url:"activity/share",data:{activity_id:this.id},success:function(e){var i=e>0?"已分享,砖瓦+"+e:"已分享";t.showToast({title:i,icon:"none"})}}),e)return{title:"易建联共享服务平台",path:"/pages/index/activity/activity?id="+this.id+"&server="+i.server_people_id+"&path=/pages/index/activity/activity"}},onLoad:function(e){var i=t.getStorageSync("TOKEN"),o=this;if(!i)return this.setShareMsg({server:e.server,path:e.path+"?id="+e.id}),t.redirectTo({url:"/pages/login/login"}),!1;t.getSystemInfo({success:function(t){o.height=t.windowHeight/2+"px"}}),console.log(n("活动ID=",e.id," at pages/index/activity/activity.vue:295")),e.id&&(this.id=e.id,this.getActivity(e.id),this.getCommentList())},onReachBottom:function(){this.getCommentList()},onShow:function(){this.id>-1&&this.getActivity(this.id)},methods:{videoErrorCallback:function(){},doShare:function(){var e=this;t.share({provider:"weixin",scene:"WXSceneSession",type:5,imageUrl:"../../static/poster.png",title:"欢迎使用易建联APP",miniProgram:{id:"gh_4bf03e4d36fb",path:"/pages/index/activity/activity?id="+this.id+"&server="+this.userInfo.server_people_id+"&path=/pages/index/activity/activity",webUrl:"https://uniapp.dcloud.io",type:2},success:function(i){console.log(n("success",i," at pages/index/activity/activity.vue:327")),e.$Fetch({url:"activity/share",data:{activity_id:e.id},success:function(e){var i=e>0?"已分享,砖瓦+"+e:"已分享";t.showToast({title:i,icon:"none"})}})},fail:function(t){console.log(n("fail",t," at pages/index/activity/activity.vue:341"))},complete:function(){console.log(n("分享操作结束!"," at pages/index/activity/activity.vue:344"))}})},send:function(){var e=this;if(!this.content.trim())return t.showModal({content:"请输入内容",showCancel:!1}),!1;this.$Fetch({url:"Comment/add",data:{comment_type:0,id_value:this.id,content:this.content},success:function(i){console.log(n(i," at pages/index/activity/activity.vue:365"));var o=new Date,a=o.getMonth()+1>9?o.getMonth()+1:"0"+(o.getMonth()+1),s=o.getDate()>9?o.getDate():"0"+o.getDate(),c=o.toTimeString().split(" ")[0];console.log(n(c," at pages/index/activity/activity.vue:371")),e.comment.list.unshift({user_id:e.userInfo.id,user_name:e.userInfo.user_name,content:e.content,create_time:o.getFullYear()+"-"+a+"-"+s+" "+c,like_num:0,head_img:e.userInfo.head_img,children:null,children_num:0,is_like:0}),e.content="",t.hideKeyboard(),e.showInput=!1}})},doReply:function(t,e){this.showInput1=!0,this.replyId=t,this.to_user_name=e},send1:function(){var e=this;if(!this.content1.trim())return t.showModal({content:"请输入内容",showCancel:!1}),!1;var i=this.reply.comment.id;this.$Fetch({url:"Comment/addComment",data:{parent_id:i,to_user_id:this.replyId,content:this.content1},success:function(i){console.log(n(i," at pages/index/activity/activity.vue:411"));var o=new Date,a=o.getMonth()+1>9?o.getMonth()+1:"0"+(o.getMonth()+1),s=o.getDate()>9?o.getDate():"0"+o.getDate(),c=o.toTimeString().split(" ")[0];console.log(n(c," at pages/index/activity/activity.vue:417")),e.replyId?(console.log(n("回复评论"," at pages/index/activity/activity.vue:419")),e.reply.list.unshift({user_id:e.userInfo.id,user_name:e.userInfo.user_name,content:e.content1,create_time:o.getFullYear()+"-"+a+"-"+s+" "+c,like_num:0,head_img:e.userInfo.head_img,is_like:0,to_user_name:e.to_user_name})):(console.log(n("回复回复"," at pages/index/activity/activity.vue:431")),e.reply.list.unshift({user_id:e.userInfo.id,user_name:e.userInfo.user_name,content:e.content1,create_time:o.getFullYear()+"-"+a+"-"+s+" "+c,like_num:0,head_img:e.userInfo.head_img,is_like:0,to_user_name:e.to_user_name})),e.content1="",t.hideKeyboard(),e.showInput1=!1}})},getActivity:function(t){var e=this;this.$Fetch({url:"activity/getDataById",data:{id:t},success:function(t){console.log(n(t," at pages/index/activity/activity.vue:455")),e.activity=t,e.author=t.adminUser,e.attention=t.attention,e.is_collect=t.is_collect,e.is_like=t.is_like,e.is_baoming=t.is_baoming,e.max=t.activity_num-t.people_num;var i=t.start_time.replace(/\-/g,"/"),o=t.end_time.replace(/\-/g,"/"),a=(new Date).getTime();a<new Date(i).getTime()?e.type=0:a<=new Date(o).getTime()?e.type=1:e.type=2}})},doAttention:function(e){var i=this;console.log(n("关注",e," at pages/index/activity/activity.vue:478")),this.$Fetch({url:"Attention/add",data:{id:e},debug:!0,success:function(e){console.log(n(e," at pages/index/activity/activity.vue:484")),i.attention=e.success;var o=1===e.success?"已关注,砖瓦+"+e.point:"已取消关注";t.showToast({title:o,icon:"none"})}})},doCollect:function(e){var i=this;this.$Fetch({url:"Collect/add",data:{collect_type:1,id_value:this.id},debug:!0,success:function(e){console.log(n(e," at pages/index/activity/activity.vue:504")),i.is_collect=e.success;var o=1===e.success?"已收藏,砖瓦+"+e.point:"已取消收藏";t.showToast({title:o,icon:"none"})}})},doZan:function(e){var i=this;this.$Fetch({url:"user_like/add",data:{like_type:1,id_value:this.id},success:function(e){console.log(n(e," at pages/index/activity/activity.vue:523")),i.is_like=e.success;var o=1===e.success?"已点赞,砖瓦+"+e.point:"已取消点赞";t.showToast({title:o,icon:"none"})}})},getCommentList:function(){var t=this,e=this.comment;e.loading&&(e.loading=!1,this.comment=e,this.$Fetch({url:"Comment/getData",data:{comment_type:0,id_value:this.id,pageNum:e.pageNum,pageSize:e.pageSize},success:function(i){var n=i.lists;n.length>0?(e.list=e.list.concat(n),n.length===e.pageSize?(e.pageNum++,e.loading=!0,e.more=!0):e.more=!1):e.more=!1,t.comment=e}}))},addCommentLike:function(t,e){this.$Fetch({url:"Comment/addCommentLike",data:{id:t.id},success:function(e){t.is_like=e,1===e?t.like_num++:t.like_num--}})},closePopup:function(){this.pl=!1,this.reply={comment:{},pageNum:1,pageSize:10,list:[],loading:!0,more:!1}},showPopup:function(t){this.getReply(t),this.pl=!0},getReply:function(t){var e=this,i=this.reply;i.comment=t,this.reply=i,i.loading&&(i.loading=!1,this.reply=i,this.$Fetch({url:"Comment/getComment",data:{id:t.id,pageNum:i.pageNum,pageSize:i.pageSize},debug:!0,success:function(t){var n=t.length;n>0?(i.list=i.list.concat(t),n===i.pageSize?(i.pageNum++,i.loading=!0,i.more=!0):i.more=!1):i.more=!1,e.reply=i,e.pl=!0}}))},onSubmit:function(e){console.log(n("提交数据：",e.detail.value," at pages/index/activity/activity.vue:632")),this.$Fetch({url:"activity_list/add",data:e.detail.value,success:function(e){console.log(n(e," at pages/index/activity/activity.vue:637")),t.navigateTo({url:"../success/success?id="+e})}})}}};e.default=u}).call(this,i("6e42")["default"],i("0de9")["default"])},f054:function(t,e,i){"use strict";i.r(e);var n=i("adbe"),o=i("bcd5");for(var a in o)"default"!==a&&function(t){i.d(e,t,function(){return o[t]})}(a);i("6b3d");var s=i("2877"),c=Object(s["a"])(o["default"],n["a"],n["b"],!1,null,"007aef46",null);e["default"]=c.exports}},[["d313","common/runtime","common/vendor"]]]);