(global["webpackJsonp"]=global["webpackJsonp"]||[]).push([["pages/index/index"],{"08ab":function(e,t,n){"use strict";var r=function(){var e=this,t=e.$createElement;e._self._c},a=[];n.d(t,"a",function(){return r}),n.d(t,"b",function(){return a})},"289b":function(e,t,n){},"2b5c":function(e,t,n){"use strict";(function(e){n("4ea4"),n("921b");r(n("66fd"));var t=r(n("c206"));function r(e){return e&&e.__esModule?e:{default:e}}e(t.default)}).call(this,n("6e42")["createPage"])},"2e2b":function(e,t,n){"use strict";n.r(t);var r=n("f429"),a=n.n(r);for(var i in r)"default"!==i&&function(e){n.d(t,e,function(){return r[e]})}(i);t["default"]=a.a},"5a9a":function(e,t,n){"use strict";var r=n("289b"),a=n.n(r);a.a},c206:function(e,t,n){"use strict";n.r(t);var r=n("08ab"),a=n("2e2b");for(var i in a)"default"!==i&&function(e){n.d(t,e,function(){return a[e]})}(i);n("5a9a");var o=n("2877"),u=Object(o["a"])(a["default"],r["a"],r["b"],!1,null,"7fd18188",null);t["default"]=u.exports},f429:function(e,t,n){"use strict";(function(e,r){Object.defineProperty(t,"__esModule",{value:!0}),t.default=void 0;var a=n("2f62");function i(e){for(var t=1;t<arguments.length;t++){var n=null!=arguments[t]?arguments[t]:{},r=Object.keys(n);"function"===typeof Object.getOwnPropertySymbols&&(r=r.concat(Object.getOwnPropertySymbols(n).filter(function(e){return Object.getOwnPropertyDescriptor(n,e).enumerable}))),r.forEach(function(t){o(e,t,n[t])})}return e}function o(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var u=function(){return Promise.all([n.e("common/vendor"),n.e("components/articleList")]).then(n.bind(null,"29ef"))},s={data:function(){return{banner:[{img:n("ab3d")}],zizhi:[],type:1,more:!1,pageNum:1,pageSize:10,loading:!0,list:[],imgList:[]}},computed:i({},(0,a.mapState)(["isLogin","userInfo","city","uList","msgNum","count"])),components:{articleList:u},onShareAppMessage:function(){var t=e.getStorageSync("userInfo");if(e.getStorageSync("TOKEN"))return{title:"易建联共享服务平台",path:"/pages/index/index?server="+t.server_people_id}},onLoad:function(t){var n=this;this.$Fetch({url:"picture/getData",success:function(e){n.zizhi=e.picture;var t=!0,r=!1,a=void 0;try{for(var i,o=e.picture[Symbol.iterator]();!(t=(i=o.next()).done);t=!0){var u=i.value;n.imgList.push(u.img)}}catch(s){r=!0,a=s}finally{try{t||null==o.return||o.return()}finally{if(r)throw a}}e.banner.length>0&&(n.banner=e.banner)}}),this.getList(),t.server&&this.setShareMsg({server:t.server});var a=this;e.getStorageSync("TOKEN")&&(console.log(r(e.getStorageSync("TOKEN")," at pages/index/index.vue:106")),this.$Fetch({url:"user/getDataById",success:function(t){n.setInfo(t),e.setStorageSync("userInfo",t),e.connectSocket({url:"wss://yjl.tao.li4.cn:8282"}),e.onSocketOpen(function(n){var r=plus.push.getClientInfo().clientid;e.sendSocketMessage({data:JSON.stringify({type:"bind",user_id:t.id,user_child_getui:r}),success:function(){}}),e.onSocketMessage(function(t){a.$Fetch({url:"user_chat/getDataList",success:function(e){a.updateUlist(e)}});var n=JSON.parse(t.data);if(e.$emit("onMessage",n),"text"===n.type){a.setMsgNum(a.msgNum+1);var r=a.uList,i=!0,o=!1,u=void 0;try{for(var s,c=r[Symbol.iterator]();!(i=(s=c.next()).done);i=!0){var l=s.value;l.id===n.user_id&&(l.count?l.count++:l.count=1)}}catch(h){o=!0,u=h}finally{try{i||null==c.return||c.return()}finally{if(o)throw u}}a.updateUlist(r);var f={cover:!1},g=getCurrentPages(),d=g[g.length-1].route;"pages/message/chat/chat"!==d&&(plus.push.createMessage(n.user_name+"："+n.content,t.data,f),plus.push.addEventListener("click",function(t){var n=JSON.parse(t.payload);n.id=n.user_id,n.head_img=n.user_head_img,e.switchTab({url:"/pages/message/message"})}))}})}),e.onSocketClose(function(t){e.getStorageSync("TOKEN")&&e.connectSocket({url:"wss://yjl.tao.li4.cn:8282"})}),e.onSocketError(function(t){e.getStorageSync("TOKEN")&&e.connectSocket({url:"wss://yjl.tao.li4.cn:8282"})}),n.$Fetch({url:"user_chat/NoReadNum",success:function(e){n.setMsgNum(e)}}),n.$Fetch({url:"user_chat/getNoRead",success:function(e){var t=n.uList,r=!0,a=!1,i=void 0;try{for(var o,u=e[Symbol.iterator]();!(r=(o=u.next()).done);r=!0){var s=o.value;for(var c in t)if(s.user_id===t[c].id){var l=t[c];l.content=s.content,l.count=s.count,t[c]=l}}}catch(f){a=!0,i=f}finally{try{r||null==u.return||u.return()}finally{if(a)throw i}}n.updateUlist(t)}})}}))},onReachBottom:function(){this.getList()},onPullDownRefresh:function(){var e=this;this.$Fetch({url:"picture/getData",success:function(t){e.zizhi=t.picture;var n=!0,r=!1,a=void 0;try{for(var i,o=t.picture[Symbol.iterator]();!(n=(i=o.next()).done);n=!0){var u=i.value;e.imgList.push(u.img)}}catch(s){r=!0,a=s}finally{try{n||null==o.return||o.return()}finally{if(r)throw a}}t.banner.length>0&&(e.banner=t.banner)}}),this.getList()},methods:i({},(0,a.mapMutations)(["setInfo","updateUlist","setMsgNum","setCount","setShareMsg"]),(0,a.mapActions)(["navFilter"]),{previewImage:function(t){e.previewImage({current:t,urls:this.imgList})},getList:function(){var e=this;this.loading&&(this.loading=!1,this.$Fetch({url:"news/recommend",data:{pageNum:this.pageNum,pageSize:this.pageSize},success:function(t){var n=t.lists;n.length>0?(e.list=e.list.concat(n),n.length===e.pageSize?(e.pageNum++,e.loading=!0,e.more=!0):e.more=!1):e.more=!1}}))}})};t.default=s}).call(this,n("6e42")["default"],n("0de9")["default"])}},[["2b5c","common/runtime","common/vendor"]]]);